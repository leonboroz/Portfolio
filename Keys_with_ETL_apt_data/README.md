## Описание проекта

### Задача

Ваша компания переходит с упрощенной системы налогообложения на общую. Бухгалтерия запросила сверку данных реализации по аптекам и выгрузки из СБИС перед загрузкой в 1С. Необходимо:

Объединить все CSV-файлы из папки Входящие в один DataFrame.

Корректно обработать заголовки столбцов, не смешивая их с данными.

Загрузить данные по каждой аптеке из Аптеки/csv/correct/ и сверить с выгрузкой из СБИС.

Сохранить итоговые файлы в Результат/{дата}/{имя файла} - результат.xlsx.

### Логика обработки

Обработка данных из СБИС:

Загружаются все CSV-файлы из папки Входящие (игнорируя другие форматы).

Объединяются в один DataFrame, с очисткой и переименованием столбцов.

Отбираются записи с определенными типами документов: СчФктр, УпдДоп, УпдСчфДоп, ЭДОНакл.

Приводится дата к формату ДД.ММ.ГГГГ.

Обработка данных по аптекам:

Загружаются файлы из Аптеки/csv/correct/, пропуская файлы неподходящего формата.

Если поставщик — ЕАПТЕКА, к номеру накладной добавляется /15.

Данные сопоставляются с выгрузкой из СБИС по Номер накладной.

В случае расхождения дат указывается 'Не совпадает!'.

Итоговые файлы сохраняются в Результат/{дата}/{имя файла} - результат.xlsx.

## Используемые технологии

Проект реализован на Python с использованием следующих библиотек:

pandas – для обработки данных

numpy – для работы с массивами

openpyxl – для работы с Excel



### Как запустить код

1. Создание виртуального окружения (если его еще нет), активируйте и получите зависимости:
    ```sh
    python -m venv venv
    venv\Scripts\activate  # Windows
    source venv/bin/activate  # Mac/Linux
    pip install -r requirements.txt

2. Либо установите необходимые библиотеки самостоятельно:
    ```sh
    pip install pandas numpy openpyxl

3. Запустите скрипт в Python:
    ```sh
    python ETL_accounting_data.py

Итоговые файлы будут сохранены в папке Результат/{дата}/.

Структура проекта

/
- ├── Аптеки/csv/correct/      # Входные данные по аптекам (CSV-файлы)
- ├── Входящие/                # Входные данные из СБИС (CSV-файлы)
- ├── Результат/               # Итоговые файлы с результатами сверки
- │   ├── {дата}/
- │   │   ├── {имя_файла_1} - результат.xlsx
- │   │   ├── {имя_файла_2} - результат.xlsx
- │   │   └── ...
- ├── ETL_accounting_data.py   # Основной скрипт обработки
- ├── README.md                # Описание проекта
- └── requirements.txt         # Зависимости

Важные моменты

Файлы должны быть в кодировке 1251.

Входные данные должны быть в формате CSV, иначе они будут проигнорированы.

Итоговые файлы формируются с учетом сверки данных и корректировки.

